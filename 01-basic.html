<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>The basics</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Mount-lite</span> <span class="project-version">0.9.6</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1  current"><a href="01-basic.html"><div class="inner"><span>The basics</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mount</span></div></div></li><li class="depth-2"><a href="mount.lite.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lite</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#the-basics" name="the-basics"></a>The basics</h1>
<h2><a href="#what-is-mount-for-" name="what-is-mount-for-"></a>What is mount for?</h2>
<h2><a href="#adding-it-to-your-project" name="adding-it-to-your-project"></a>Adding it to your project</h2>
<h2><a href="#defining-states" name="defining-states"></a>Defining states</h2>
<p>First, require the <code>mount.lite</code> namespace:</p>
<pre><code class="clj">(ns your.app
  (:require [mount.lite :refer (defstate state only except substitute) :as mount]
            [your.app.config :as config] ;; Also has a defstate defined.
            [some.db.lib :as db]))
</code></pre>
<p>The simplest of a global state definition is one with a name and a <code>:start</code> expression. In this example we also supply a <code>:stop</code> expression.</p>
<pre><code class="clj">(defstate db
  :start (db/start (get-in config/config [:db :url]))
  :stop (do (println &quot;Stopping DB...&quot;) (db/stop db)))
;=&gt; #&#39;your.app/db
</code></pre>
<blockquote>
  <p>Consider the following in your design when using Mount:</p>
  <ul>
    <li>Only use defstate in your application namespaces, not in library namespaces.</li>
    <li>Only use defstate when either the state needs some stop logic before it can be reloaded,  or whenever the state depends on another defstate. In other cases, just use a def.</li>
  </ul>
</blockquote>
<p>To start all global states, just use <code>start</code>. A sequence of started state vars is returned. The order in which the states are started is determined by their load order by the Clojure compiler (except when <a href="#parallelism">parallelism</a> is used). Using <code>stop</code> stops all the states in reverse order.</p>
<pre><code class="clj">(mount/start)
;=&gt; (#&#39;your.app.config/config #&#39;your.app/db)

db
;=&gt; object[some.db.Object 0x12345678]
</code></pre>
<p>Also note that documents strings and attribute maps are supported. So a full <code>defstate</code> might look something like this:</p>
<pre><code class="clj">(defstate ^:private db
  &quot;My database state&quot;
  {:attribute &#39;map}
  :start (db/start (get-in config/config [:db :url]))
  :stop (do (println &quot;Stopping db...&quot;) (db/stop db)))
</code></pre>
<p><em>Now you know the basics. Go on, try it! I will see you in 10 minutes.</em></p></div></div></div></body></html>