<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Extension point</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Mount-lite</span> <span class="project-version">2.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="01-basics.html"><div class="inner"><span>The basics</span></div></a></li><li class="depth-1 "><a href="02-substitutions.html"><div class="inner"><span>Substitutions</span></div></a></li><li class="depth-1 "><a href="03-start-stop-options.html"><div class="inner"><span>Start up to / stop down to</span></div></a></li><li class="depth-1 "><a href="04-systems-of-states.html"><div class="inner"><span>Multiple systems of states</span></div></a></li><li class="depth-1  current"><a href="05-extension-point.html"><div class="inner"><span>Extension point</span></div></a></li><li class="depth-1 "><a href="06-migrating-to-2.html"><div class="inner"><span>Migrating to 2.x</span></div></a></li><li class="depth-1 "><a href="07-troubleshooting.html"><div class="inner"><span>Troubleshooting</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mount</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>extensions</span></div></div></li><li class="depth-3 branch"><a href="mount.extensions.basic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>basic</span></div></a></li><li class="depth-3 branch"><a href="mount.extensions.data-driven.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>data-driven</span></div></a></li><li class="depth-3 branch"><a href="mount.extensions.explicit-deps.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>explicit-deps</span></div></a></li><li class="depth-3"><a href="mount.extensions.refresh.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>refresh</span></div></a></li><li class="depth-2"><a href="mount.lite.html"><div class="inner"><span class="tree" style="top: -145px;"><span class="top" style="height: 154px;"></span><span class="bottom"></span></span><span>lite</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#extension-point" name="extension-point"></a>Extension point</h1>
<p>In former versions of mount-lite the API gave you more fine-grained influence on what states are started or stopped when calling <code>start</code> or <code>stop</code>. You could tell mount to <code>only</code> start/stop certain states, or start/stop all states <code>except</code> some. You could tell mount to determine the dependencies of a state more accurately by building a dependency graph using the <a href="https://github.com/clojure/tools.namespace">tools.namespace</a> library.</p>
<p>These features have been removed from the API, for <a href="http://www.functionalbytes.nl/clojure/mount/mount-lite/2016/12/09/mount-lite-2.html">various reasons</a>. However, an extension point is available, in case you want these or other features that influence what is started or stopped. Future versions of mount-lite may even provide implementations for these, using the extension point discussed below. In any case, the core API and implementation is not affected by these features and can be kept simple and lite.</p>
<h3><a href="#the-states-dynamic-var" name="the-states-dynamic-var"></a>The *states* dynamic var</h3>
<p>The root binding of the dynamic <code>*states*</code> var is used by the internals of mount-lite to keep track of what global <code>defstates</code> have been defined, and in what order. The root binding is an atom of namespaced keywords, which can be resolved back to the <code>defstate</code> vars. These keywords are automatically pruned, in case some <code>defstate</code> may have been unmapped.</p>
<p>The <code>start</code> and <code>stop</code> functions read from the atom in the <code>*states*</code> var, to determine what states are available for starting or stopping. By binding the <code>*states*</code> var to an atom of your own, holding a different set of namespaced keywords, you effectively influence the <code>start</code> and <code>stop</code> function in this regard.</p>
<p>Do not fiddle with the root binding of the <code>*states*</code> var directly!</p>
<h3><a href="#bringing-back-only" name="bringing-back-only"></a>Bringing back “only”</h3>
<p>For example, if you’d really need the <a href="mount.extensions.basic.html#var-with-only"><code>only</code></a> option back, you could do the following:</p>
<pre><code class="clj">(defmacro with-only
  [states &amp; body]
  `(binding [*states* (atom (map var-&gt;keyword ~states))]
     ~@body))
</code></pre></div></div></div></body></html>