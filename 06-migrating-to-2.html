<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>Migrating to 2.x</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Mount-lite</span> <span class="project-version">2.0.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="01-basics.html"><div class="inner"><span>The basics</span></div></a></li><li class="depth-1 "><a href="02-substitutions.html"><div class="inner"><span>Substitutions</span></div></a></li><li class="depth-1 "><a href="03-start-stop-options.html"><div class="inner"><span>Start up to / stop down to</span></div></a></li><li class="depth-1 "><a href="04-systems-of-states.html"><div class="inner"><span>Multiple systems of states</span></div></a></li><li class="depth-1 "><a href="05-extension-point.html"><div class="inner"><span>Extension point</span></div></a></li><li class="depth-1  current"><a href="06-migrating-to-2.html"><div class="inner"><span>Migrating to 2.x</span></div></a></li><li class="depth-1 "><a href="07-troubleshooting.html"><div class="inner"><span>Troubleshooting</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mount</span></div></div></li><li class="depth-2"><a href="mount.lite.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lite</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#migrating-to-2-x" name="migrating-to-2-x"></a>Migrating to 2.x</h1>
<p>Version 2.0 was a breaking version. This guide sums up what has changed.</p>
<h2><a href="#simplified-start-stop" name="simplified-start-stop"></a>Simplified start/stop</h2>
<p>Where the <code>start</code> and <code>stop</code> functions used to take zero to multiple &ldquo;option maps&rdquo;, they now take <a href="03-start-stop-options.html">one optional argument</a>: the &ldquo;up to&rdquo; var.</p>
<p>If you were using the <code>only</code> or <code>except</code> options, see if you can replace them with the &ldquo;up to&rdquo; approach, or with the <a href="05-extension-point.html">extension point</a>, or keep using the 0.9.x version.</p>
<h2><a href="#dereferencing" name="dereferencing"></a>Dereferencing</h2>
<p>To use the value of a started state, you need to dereference it by using <code>@</code> or <code>deref</code> now. Dereferencing a stopped state yields an exception.</p>
<h2><a href="#substitutes-need-to-be-defined-with-the-state-macro" name="substitutes-need-to-be-defined-with-the-state-macro"></a>Substitutes need to be defined with the <em>state</em> macro</h2>
<p>Substitutes cannot be defined as a simple map anymore. Please use the <code>state</code> macro to create anonymous states. The syntax for the <code>state</code> macro has not changed though, with respect to versions before 2.0. For example:</p>
<pre><code class="clj">;; This is not supported anymore
(def sub {:start (fn [] ...)})

;; This is the only supported syntax now
(def sub (state :start ...))
</code></pre>
<h2><a href="#no-more-reloading-behaviour" name="no-more-reloading-behaviour"></a>No more reloading behaviour</h2>
<p>States are not automatically stopped anymore on redefinition. You need to manually <code>stop</code> and <code>start</code> your states, or use the <a href="https://github.com/clojure/tools.namespace">tools.namespace</a> library. This also means that the <code>:on-reload</code> and <code>:on-cascade</code> options of <code>defstate</code> are gone, just as the <code>on-reload</code> function</p>
<h2><a href="#no-more-graphs" name="no-more-graphs"></a>No more graphs</h2>
<p>Detecting the dependency graph for the <code>defstates</code> has been removed. It may return in a future version, as an opt-in extension. This means that the &ldquo;up-to&rdquo; behaviour may now start or stop more states than you were used to.</p>
<h2><a href="#no-more-parallel" name="no-more-parallel"></a>No more parallel</h2>
<p>Because state dependency graphs have been removed for now, starting or stopping states in <code>parallel</code> has been removed as well.</p>
<h2><a href="#no-more-bindings" name="no-more-bindings"></a>No more bindings</h2>
<p>The <code>bindings</code> feature has been removed as well. It was rarely used, and only added complexity to the macros. If you use the feature, it can easily be replaced by many other means.</p></div></div></div></body></html>